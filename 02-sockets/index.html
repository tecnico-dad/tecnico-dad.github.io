<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
    <link rel="stylesheet" type="text/css" href="../_css/labs-sd.css">

    <link href="../_prettify/prettify.css" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="../_prettify/prettify.js"></script>

    <title>Sockets</title>
</head>

<body onload="prettyPrint()">

<div class="contexto">
    <p>
        <a href="../index.html">Labs SD</a> &gt;
    </p>
</div>

<div class="titulo" id="1">
    <h1><i>Sockets</i></h1>
</div>

<!--div class="objectivos">
    <h2>Objectivos da semana</h2>
    <ul>
        <li>Usar <i>sockets</i> para transferir dados entre cliente e servidor</li>
    </ul>
</div-->

<div class="indice">
</div>

<div class="corpo">

<p>
<i>Antes de começar</i> vamos relembrar as ferramentas que vão ser usadas e que foram apresentadas no laboratório anterior:
</p>
<ul>
    <li>o Java (linguagem e plataforma de execução),</li>
    <li>o Maven (automatização da construção das aplicações), e</li>
    <li>o Eclipse (ambiente integrado de desenvolvimento).</li>
</ul>

<p>Mais explicação e exemplos podem ser consultados na página das <a href="../01-tools/index.html">ferramentas</a>.</p>

<p>
Passemos agora ao tema principal do laboratório: a comunicação com Sockets.
</p>


<hr />

<h2><i>Sockets</i></h2>

<p>
Um <i>Berkeley Socket</i>, ou simplesmente <i>Socket</i> é uma extremidade de uma ligação através de uma rede de computadores.
Atualmente,
a comunicação entre computadores faz-se quase sempre com IP (<i>Internet Protocol</i>).
Os <i>sockets</i> mais comuns usam TCP (<i>Transmission Control Protocol</i>),
que estabelecem uma ligação entre cliente e servidor.
Um endereço de <i>socket</i> é composto por um endereço IP e
por um número de porto.
</p>
<p>
<img height="70" src="connection.png" />

<p>
O Java disponibiliza uma biblioteca de <i>sockets</i> que
está disponível no pacote <tt>java.net</tt>.
O exemplo seguinte
- servidor e cliente -
ilustra a comunicação entre dois programas usando esta biblioteca.
</p>
<ul>
    <li>
        <a href="socket-server.zip">Servidor de <i>Sockets</i> TCP/IP
        <img src="../_img/zip.png" alt="ZIP" ></a>
        - transferência de texto com sockets TCP/IP
    </li>
    <li>
        <a href="socket-client.zip">Cliente de <i>Sockets</i> TCP/IP
        <img src="../_img/zip.png" alt="ZIP" ></a>
    </li>
</ul>

<p>
O <i>Socket</i> define uma interface de programação, mas não define o conteúdo e significado das mensagens.
Um <b>protocolo de comunicação</b> é um sistema de regras que define uma convenção para permitir que diferentes entidades troquem informação de forma não ambígua.
<!--
Quando duas pessoas conversam existem várias regras escondidas mas bem conhecidas por todos nós:</br>
As duas pessoas começam por se cumprimentar quando se vêm e depois iniciam a conversa.
Com o decorrer da conversa dá para entender que as duas pessoas estão sincronizadas, isto é não falam uma por cima da outra.</br>
Para tal acontecer existem deixas (maioritariamente auditivas) que permitem à pessoa que está a ouvir perceber que está na altura de começar a falar, nomeadamente o orador deixar de falar.</br></br>
-->
Estas regras são mais evidentes, por exemplo, quando estamos perante uma conversa de <i>walkie talkies</i>: podemos ouvir os interlocutores a usar deixas como <b>"Escuto"</b> para indicar que pararam de falar.<br />
<br />
<img height="60" src="walkietalkies.jpg" /><br />
<br />
Assim tem que ser na comunicação em sockets.
É preciso "dizer" como é enviado um pedido, quando termina o pedido, quando chega a resposta, quando já foi recebida, e assim por diante.
<p>

<p>
Os <i>sockets</i> estão na base da programação da comunicação na <i>World Wide Web</i> (WWW).
O porto 80 é reservado para comunicação por TCP/IP entre o cliente e o servidor, seguindo o <b>protocolo HTTP</b> (HyperText Transfer Protocol).
</p>
<ul>
    <li>Consultar Secção 1.6 do livro da cadeira sobre <i>World Wide Web</i> e <i>Sockets</i></li>
    <li><a href="www/index.html">(Breve) introdução à World Wide Web</a></li>
</ul>

<p>&nbsp;</p>

<hr />

<h2>Exercício a resolver até ao fim da aula</h2>

<ol>
    <li>Obter o exemplo de <b>sockets TCP/IP</b>.<br />
    Neste caso temos dois programas que colaboram entre si.</li>
    <ol type="a">
        <li>
        Configurar os projectos no Eclipse
        </li>
        <li>
        Estudar o código fonte e
        os ficheiros <tt>pom.xml</tt> do servidor e do cliente.
        </li>
        <li>
        Compilar e executar o servidor e cliente,
        seguindo as instruções no ficheiro <tt>readme.txt</tt>
        </li>
    </ol>
</ol>

<p>
<b>Problemas?</b> Observar atentamente as <a href="../01-tools/exceptions/index.html">exceções</a> produzidas.
</p>
<ol start="2">
    <li>
    Analisar o <i>output</i> do Maven,
    em especial as linhas começadas por <small>[WARNING]</small>:
    </li>
    <ol type="a">
        <li>
        Qual foi a causa da exceção?
        </li>
		<li>
        Que exceção é que foi lançada?
        </li>
		<li>
        Em que linha do código do cliente é que foi lançada a exceção?
        </li>
        <ul>
            <li>Ou será um problema na configuração dos argumentos?</li>
        </ul>
	</ol>
</ol>

<ol start="3">
    <li>Compilar e executar o servidor até funcionar sem erros.</li>
</ol>

<ul>
    <li>
    Em casos mais complicados,
    pode usar-se o depurador (<i>debugger</i>):
    </li>
    <ul>
        <li>
        Criar um <i>breakpoint</i> no servidor,
        na linha desejada
        </li>
        <li>
        Inspeccione o valor das variáveis relevantes
        </li>
    </ul>
</ul>

<p>
Problema resolvido?
<a href="http://www.phdcomics.com/comics/archive.php?comicid=180">Sim</a> ou
<a href="https://upload.wikimedia.org/wikipedia/commons/thumb/3/30/Keep_Calm_and_Carry_On_Poster.svg/683px-Keep_Calm_and_Carry_On_Poster.svg.png">Não</a>? :)<br />
Retomar o exercício:
</p>

<ol start="4">
    <li>
    <b>Modificar os programas para que o servidor
    responda ao cliente com uma mensagem de confirmação.</b>
    </li>
    <li>
    ... o resto do enunciado será entregue no início da aula.
    </li>
</ol>

</div>

<p>&nbsp;</p>


<div class="objectivos">
    <h2>Entrega da solução</h2>

    <span style="color:red;font-size:90%">
    A solução do exercício desta aula <b>não</b> conta para a avaliação,
    mas deverá ser entregue da forma descrita abaixo.
    </span>

    <p>Fénix, Avaliação, Projetos, <b>mini Exercício 0</b></p>

    <p>
	A solução completa deverá ser submetida no Fénix
    <b>antes do fim da sua aula de laboratório</b>.<br />
	Trabalhos submetidos depois da hora de fim da aula não serão considerados.
    </p>

    <p>
	<b>Ter atenção ao seguinte:</b>
	</p>
	<ul>
		<li>Só serão aceites trabalhos de estudantes que estiveram presentes no laboratório.</li>
		<li>Assegure-se que a solução é enviada em formato ZIP e
		    que não contém código compilado.<br />
            (faça <tt>mvn clean</tt> antes de zipar)</li>
        <!--li>Deverá incluir um ficheiro <tt>respostas.txt</tt>
        com as respostas (breves) às perguntas do enunciado do exercício.</li-->
        <li>Deverá <!--também--> incluir um ficheiro <tt>instrucoes.txt</tt>
        com resumo da funcionalidade implementada e
        com instruções para colocar o programa a funcionar como esperado.<br />
        Por exemplo:</li>
        <ul>
            <li>A funcionalidade pedida foi total/parcialmente implementada <b>...</b></li>
            <li>O servidor deve executar com o comando:
                <tt>mvn package exec:java</tt>
            </li>
            <li>O cliente deve executar com o comando:
                <tt>mvn compile exec:java</tt>
            </li>
        </ul>
	</ul>
</div>

<p>&nbsp;</p>

<hr />

<div class="rodape">
<p>
&copy; Docentes de Sistemas Distribu&iacute;dos,
<a href="http://www.dei.tecnico.ulisboa.pt/">Dep. Eng. Informática</a>,
<a href="http://www.ist.eu">Técnico Lisboa</a><br />
</p>
</div>

</body>
</html>
